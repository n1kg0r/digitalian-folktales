<!DOCTYPE html>

<html>
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="../style/index.css">
        <script src="https://d3js.org/d3.v6.js"></script>
    </head>

    <body>
        
        <div class="contents">

            <section class="contents-header" style="min-width: 60rem;">
                <div class="logo-container">
                    <div class = "logo-small">
                        <span><a href="../index.html">digitalian</a></span>
                        <span><a href="../index.html">folktales</a></span>
                    </div>
                </div>
                <div style="width: 4rem;"></div>
                <div style="
                flex-grow: 1; 
                display: flex; 
                justify-content: center; 
                align-items: baseline; 
                ">
                    <span style="text-align: center;
                    font-family: 'Courier New', Courier, monospace;
                    cursor: default;
                    font-size: 2.2rem;
                    ">Comparing Stories</span>
                </div>
                
                <div class = "contents-header-menu">
                    <span>user guide</span>
                    <span>who we are</span>
                    <span>IT</span>
                </div>
            </section>



            <section class="contents-body">

                <div class="contents-comparison" style=" width: 100%; height: 100%; ">
                    
                    <div class="contents-comparison-body">

                        

                        <section class="carousel-section;" style="height: 100%; width: 100%;  display: flex;
                            position: relative;
                            overflow: hidden;
                            justify-content: center;
                            align-items: center;
                            "
                        >

                              <button class="slide-arrow arrow-disabled" id="slide-arrow-prev">
                                &#8249;
                              </button>
                              <button class="slide-arrow" id="slide-arrow-next">
                                &#8250;
                              </button>

                              <ul class="slides-container" id="slides-container" style="
                                display: flex;
                                overflow-x: hidden;
                                overflow-y: hidden;
                                scroll-behavior: smooth;
                                list-style: none;
                                width: 100%;
                                height: 100%;
                                margin: 0;
                                padding: 0;
                                min-height: 36rem;
                              ">
                                <li class="slide" >
                                    <div class="original-header" style="grid-column: 1; grid-row: 1;  display: flex; justify-content: center; align-items: flex-end;">
                                        <span class="map-label"><a href="gesù-e-san-pietro-in-friuli.html">Gesù e San Pietro in Friuli</a></span>
                                    </div>
        
                                    <div class="translation-header" style="grid-column: 2; grid-row: 1;  display: flex; justify-content: center; align-items: flex-end;">
                                        <span class="map-label"><a href="gesù-e-san-pietro-in-friuli.html">Gesù e San Pietro in Sicilia</a></span>
                                    </div>
        
                                    <div class="original-text" style="grid-column: 1; grid-row: 2;  display: flex; justify-content: center; align-items: center;">
                                        <span style="width: 90%; min-width: 15rem; height: 90%;  min-height: 30rem; border-radius: 0.2rem; box-shadow: 0px 0px 10px 1px lightgray; display: flex; justify-content: center; align-items: center;">
                                            <p style="width: 90%; height: 90%;  overflow-y: scroll; max-height: 28rem">
                                            </p>
                                        </span>
                                    </div>
        
                                    <div class="translation-text" style="grid-column: 2; grid-row: 2;  display: flex; justify-content: center; align-items: center;">
                                        <span style="width: 90%; min-width: 15rem; height: 90%; min-height: 30rem; border-radius: 0.2rem; box-shadow: 0px 0px 10px 1px lightgray; display: flex; justify-content: center; align-items: center;">
                                            <p style="width: 90%; height: 90%;  overflow-y: scroll; max-height: 28rem">
                                            </p>
                                        </span>
                                    </div>
                                </li>
                                <li class="slide">
                                    <div class="original-header" style="grid-column: 1; grid-row: 1;  display: flex; justify-content: center; align-items: flex-end;">
                                        <span class="map-label">stories' typology</span>
                                    </div>
        
                                    <div class="translation-header" style="grid-column: 2; grid-row: 1;  display: flex; justify-content: center; align-items: flex-end;">
                                        <span class="map-label">stories' measurements</span>
                                    </div>
        
                                    <div class="original-text" style="grid-column: 1; grid-row: 2;  display: flex; justify-content: center; align-items: center;">
                                        
                                        <span style="width: 90%; min-width: 15rem; height: 90%; min-height: 30rem; border-radius: 0.2rem; box-shadow: 0px 0px 10px 1px lightgray; display: flex; justify-content: center; align-items: center;">
                                            <div class="typology-table" 
                                                style="
                                                width: 90%; 
                                                height: 90%;  
                                                overflow-y: scroll; 
                                                max-height: 28rem;
                                                display: grid;
                                                grid-template-columns: 2fr 3fr 3fr;
                                                grid-template-rows: repeat(14, 1fr);
                                                ">

                                                <span class="typology-feature" style="grid-column-start: 1; grid-column-end: 4; font-size: 1.2rem; font-family: Courier, monospace; border-right: none">document's features</span>     

                                                <span class="typology-feature">name</span>
                                                <span class="table-middle">Gesù e San Pietro in Friuli</span>
                                                <span>Gesù e San Pietro in Sicilia</span>

                                                <span class="typology-feature">geography of origin</span>
                                                <span class="table-middle">I: Cormòns<br/>II: Cormòns<br/>III: Enemonzo e Preone</span>
                                                <span>Storia I e II Bagheria (PA)</span>

                                                <span class="typology-feature">documentation time</span>
                                                <span class="table-middle" style="justify-content: right;
                                                text-align: right;
                                                margin-right: 0;">Not Specified</span>
                                                <span style="justify-content: right;
                                                text-align: right;
                                                margin-right: 0;">Not Specified</span>

                                                <span class="typology-feature">ATU Index</span>
                                                <span class="table-middle">I: 774 Jests about Christ and Peter<br/><br/>II: 785 Lamb’s heart<br/><br/>III: 750B Hospitality Rewarded</span>
                                                <span>774: Jests About Christ and Peter</span>

                                                <span class="typology-feature">narrator/original name</span>
                                                <span class="table-middle">I: Mrs. Caterina Braida (Minèn) <br/><br/>II: Mr. Giovanni Minèn <br/><br/>III: Mrs. Iole Taddio (Iole di Mini)</span>
                                                <span>Mr. Gargano</span>

                                                <span class="typology-feature">Calvino's source</span>
                                                <span class="table-middle">Dolfo Zorzùt, Sot la nape…(I racconti del popolo friulano) (3 voll.) Udine 1924, 1925, 1927.</span>
                                                <span>Fiabe, novelle e racconti popolari siciliani, raccolti e illustrati da Giuseppe Pitrè (4 voll.), Palermo 1875. Part of Biblioteca delle tradizioni popolari siciliane, voll. IV-VII.</span>
                                                

                                                <span class="typology-feature" style="border-right: none; grid-column-start: 1; grid-column-end: 4; padding-top: 3rem;  font-size: 1.2rem; font-family: Courier, monospace;">Propp's ontology</span>   

                                                <span class="typology-feature">resolution</span>
                                                <span class="table-middle">I: Positive <br/>II: Positive <br/>III: Positive </span>
                                                <span>I: Mixed <br/>II: Positive</span>    

                                                <span class="typology-feature">animals</span>
                                                <span class="table-middle">II: Hare</span>
                                                <span>None</span>

                                                <span class="typology-feature">places</span>
                                                <span class="table-middle">I: Peter’s house, road, field <br/><br/>II: Village, Town, King’s daughter room <br/><br/>III: Woman’s house, Poor house, Manure</span>
                                                <span>I: Countryside/ Road, Village 1, Village 2. <br/><br/>II: Outside, Dead Woman House</span>

                                                <span class="typology-feature">action or events</span>
                                                <span class="table-middle">II: Joke, healing</span>
                                                <span>I: Transmutation, Joke <br/>II: Death, Resurrection</span>

                                                <span class="typology-feature">people</span>
                                                <span class="table-middle">I: Peter, Peter’s wife, Stranger/ The Lord, Delusional Owners <br/><br/>II: The Lord, St. Peter, Host, Soldier 1, King, King’s daughter, physicians, Soldiers <br/><br/>III: Jesus, St. Peter, Comare Giacoma, Mrs. Catìn 
                                                </span>
                                                <span>I: Apostles, Jesus, St. Peter <br/><br/>II: Apostles, <br/>The Master/ The Lord, St. Peter, Man 1, Man 2, Mother.</span>

                                                <span class="typology-feature">supernatural beings</span>
                                                <span class="table-middle">II: The Lord</span>
                                                <span>I: Jesus *He is capable of the magical features in the text <br/><br/>II: The Master/ The Lord *He is capable of the magical features in the text </span>

                                            </div>
                                            
                                        </span>
                                    </div>
        
                                    <div class="translation-text" style="grid-column: 2; grid-row: 2;  display: flex; justify-content: center; align-items: center;">
                                        
                                        <span style="width: 90%; min-width: 15rem; height: 90%; min-height: 30rem; border-radius: 0.2rem; box-shadow: 0px 0px 10px 1px lightgray; display: flex; justify-content: center; align-items: center;">
                                            <div class="typology-table" 
                                                style="
                                                width: 90%; 
                                                height: 90%;  
                                                overflow-y: scroll; 
                                                max-height: 28rem;
                                                display: grid;
                                                grid-template-columns: 4fr 3fr 3fr;
                                                grid-template-rows: repeat(13, 1fr);
                                                ">

                                                

                                                <span class="typology-feature" 
                                                style="grid-column-start: 1; 
                                                grid-column-end: 4; 
                                                font-size: 1.2rem; 
                                                font-family: Courier, monospace;
                                                border-right: none">basic metrics</span>     


                                                <span class="typology-feature">name</span>
                                                <span class="table-middle">Gesù e San Pietro in Friuli</span>
                                                <span>Gesù e San Pietro in Sicilia</span>

                                                <span class="typology-feature">average sentence length</span>
                                                <span class="table-middle">12.74</span>
                                                <span>11.88</span>

                                                <span class="typology-feature">maximum sentence length</span>
                                                <span class="table-middle">50</span>
                                                <span>38</span>

                                                <span class="typology-feature">average word length</span>
                                                <span class="table-middle">4.08</span>
                                                <span>4.18</span>

                                                <span class="typology-feature">maximum word length</span>
                                                <span class="table-middle">16</span>
                                                <span>15</span>

                                                <span class="typology-feature">average of syllables per word</span>
                                                <span class="table-middle">1.76</span>
                                                <span>1.79</span>


                                                

                                                <span class="typology-header" 
                                                style="grid-column-start: 1; 
                                                grid-column-end: 4; 
                                                padding-top: 3rem;  
                                                font-size: 1.2rem; 
                                                font-family: Courier, monospace;
                                                border-right: none; justify-content: left;">vocabulary</span>   

                                                <span class="typology-feature"><a href="https://en.wikipedia.org/wiki/Lexical_density">type-token ratio</a></span>
                                                <span class="table-middle">0.31</span>
                                                <span>0.36</span>

                                                <span class="typology-feature"><a href="https://en.wikipedia.org/wiki/Lexical_density">lexical density</a></span>
                                                <span class="table-middle">0.45</span>
                                                <span>0.5</span>




                                                <span class="typology-header" 
                                                style="grid-column-start: 1; 
                                                grid-column-end: 4; 
                                                padding-top: 3rem;  
                                                font-size: 1.2rem; 
                                                font-family: Courier, monospace;
                                                border-right: none;
                                                justify-content: left;">text complexity</span>   

                                                <span class="typology-feature">hard words quantity</span>
                                                <span class="table-middle">602</span>
                                                <span>393</span>

                                                <span class="typology-feature"><a href="https://en.wikipedia.org/wiki/Flesch%E2%80%93Kincaid_readability_tests">Fry readability formula</a></span>
                                                <span class="table-middle">45.37</span>
                                                <span>43.67</span>

                                                <span class="typology-feature"><a href="https://en.wikipedia.org/wiki/Gunning_fog_index">Gunning fog index</a></span>
                                                <span class="table-middle">13.04</span>
                                                <span>13.18</span>

                                                <span class="typology-feature"><a href="https://en.wikipedia.org/wiki/Automated_readability_index">automated readability index</a></span>
                                                <span class="table-middle">3.79</span>
                                                <span>3.86</span>

                                                <span class="typology-feature"><a href="https://en.wikipedia.org/wiki/SMOG">SMOG grade</a></span>
                                                <span class="table-middle">12.21</span>
                                                <span>12.16</span>

                                                <span class="typology-feature"><a href="https://en.wikipedia.org/wiki/Coleman%E2%80%93Liau_index">Coleman–Liau index</a></span>
                                                <span class="table-middle">5.40</span>
                                                <span>5.86</span>




                                                <span class="typology-header" 
                                                style="grid-column-start: 1; 
                                                grid-column-end: 3; 
                                                padding-top: 3rem;  
                                                font-size: 1.2rem; 
                                                font-family: Courier, monospace;
                                                border-right: none;
                                                display: flex;
                                                flex-direction: column;
                                                align-items: left;
                                                text-align: left;"><div style="width: 100%; text-align: left;">sentiment analysis /</div><a style="width: 100%; text-align: left;" href="https://en.wikipedia.org/wiki/Coleman%E2%80%93Liau_index">MilaNLProc model</a></span>   

                                                <span class="typology-feature">average sentence positivity</span>
                                                <span class="table-middle">0.9882</span>
                                                <span>0.9971</span>

                                                <span class="typology-feature">sentence positivity std</span>
                                                <span class="table-middle">0.0482</span>
                                                <span>0.0178</span>





                                            </div>
                                            
                                        </span>

                                    </div>
                                </li>
                              </ul>
                            <!--
                            
                        -->
                        </section>

                    </div>


                </div>

            </section>



        </div>
    </body>

    

    <script>
        const namesToURLs = [
            {
                name: 'Gesù e San Pietro in Friuli',
                url: 'analysis/gesù-e-san-pietro-in-friuli.html'
            },
            {
                name: 'Gesù e San Pietro in Sicilia',
                url: 'analysis/gesù-e-san-pietro-in-sicilia.html'
            }
    ]


        function onInput() {
            var val = document.getElementById('search-input').value;
            var opts = document.getElementById('stories-names').childNodes;
            for (var i = 0; i < opts.length; i++) {

                if (opts[i].value === val) {

                    namesToURLs.forEach(element => 
                        {
                            if (element.name === val) {
                                window.open(element.url,"_self")
                            }
                        }
                    );

                    break;
                }
            }
        }






        const markers = [
            //{long: 13, lat: 46}, // friuli
            {long: 14, lat: 37.56}, // sicily
        ];

        // The svg
        const svg = d3.select("svg")
        // Map and projection
        const projection = d3.geoMercator()
            .center([9, 47])                // GPS of location to zoom on
            .scale(1750)                       // This is like the zoom
            .translate([ 100,30 ])
        
        // Load external data and boot
        //d3.json("https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson").then( function(data){
            d3.json("../topojson/it1.geojson").then( function(data){
            
            // Filter data

            // Draw the map
            svg.append("g")
                .selectAll("path")
                .data(data.features)
                .join("path")
                .attr("d", d3.geoPath()
                    .projection(projection)
                )
                .style("stroke", "black") 
                .style("fill", "none") 
                //  .on('mouseover', function(d, i) {
                //      d3.select(this)
                //      .style('stroke', '#ff0000');
                // })
                // .on('click', function(d, i) {
                //      d3.select(this)
                //      .style('fill', '#ff0000');
                // });


                


                const Tooltip = d3.select(".tooltip")

                // const Tooltip = d3.select("#map-container")
                //      .append("div")
                //      .attr("class", "tooltip")
                //      .style("opacity", 0)
                //      .style("background-color", "white")
                //      .style("padding", "5px")
                //      .style("width", "10rem")
                //      .style("height", "15rem")
                //      .style("position", "absolute")
                //      .style("border-radius", "0.2rem")
                //      .style("box-shadow", "0px 0px 10px 1px lightgray")

                     //width: 90%; 
                     //min-width: 15rem; 
                     //height: 90%; 
                     //min-height: 30rem; 
                     //border-radius: 0.2rem; 
                     //box-shadow: 0px 0px 10px 1px lightgray; 
                     //display: flex; 
                     //justify-content: center; 
                     //align-items: center;



                // Three function that change the tooltip when user hover / move / leave a cell
                const mouseover = function(event, d) {
                    Tooltip.style("opacity", 1);
                }

                var mousemove = function(event, d) {
                    
                    Tooltip
                        
                        //.style("left", projection([d.long, d.lat])[0] - 100 + 'px')
                        //.style("top", projection([d.long, d.lat])[1] -100 + 'px')
                        .style("left", (event.x)/2 + "px")
                        .style("top", (event.y)/2 + 100 + "px")
                        .style("opacity", 1)
                }

                var mouseleave = function(event, d) {
                    Tooltip
                    .style("left", projection([d.long, d.lat])[0] - 100 + 'px')
                    .style("top", projection([d.long, d.lat])[1] -100 + 'px')
                    //Tooltip.style("opacity", 0)
                }

                // Add circles:
                
                svg
                .selectAll("myCircles")
                .data(markers)
                .enter()
                .append("circle")
                    .attr("cx", function(d){ return projection([d.long, d.lat])[0] })
                    .attr("cy", function(d){ return projection([d.long, d.lat])[1] })
                    .attr("r", 14)
                    .attr("class", "circle")
                    .style("fill", "#ff0000")
                    .attr("stroke", "#bb3333")
                    .attr("stroke-width", 3)
                    .attr("fill-opacity", .2)
                    .on("mouseover", mouseover)
                    .on("mousemove", mousemove)
                    //.on("mouseleave", mouseleave)

                    // svg
                    // .append("rect")
                    // .style("opacity", 1)
                    // .attr("width", "100")
                    // .attr("stroke", "black")
                    // .attr("height", "100")
                    // .style("background-color", "red")
                    // .attr("x", projection([14, 38])[0])
                    // .attr("y", projection([14, 38])[0])

                    function equalToEventTarget() {
                        return this == d3.event.target;
                    }



                    d3.select("#map-container").on("click",function(event){
                        
                        var outside = (document.querySelector('.tooltip') !== event.target);
                        
                        if (outside) {
                            Tooltip.style("opacity", 0);
                        }
                    });
                
                
            
            
            //console.log(svg.selectAll("path"))
        })


        const slidesContainer = document.getElementById("slides-container");
        const slide = document.querySelector(".slide");
        const prevButton = document.getElementById("slide-arrow-prev");
        const nextButton = document.getElementById("slide-arrow-next");

        


        nextButton.addEventListener("click", () => {
            const slideWidth = slide.clientWidth;
            slidesContainer.scrollLeft += slideWidth;
            
            if (document.getElementById('slide-arrow-prev').classList.contains('arrow-disabled')){
                document.getElementById('slide-arrow-prev').classList.remove('arrow-disabled')
            }
            document.getElementById('slide-arrow-next').classList.add('arrow-disabled')
        });

        prevButton.addEventListener("click", () => {
            const slideWidth = slide.clientWidth;
            slidesContainer.scrollLeft -= slideWidth;

            if (document.getElementById('slide-arrow-next').classList.contains('arrow-disabled')){
                document.getElementById('slide-arrow-next').classList.remove('arrow-disabled')
            }
            document.getElementById('slide-arrow-prev').classList.add('arrow-disabled')
        });


        fetch('../texts/friuli-original.txt')
        .then(response => response.text())
        .then(text => {
            var node = document.querySelector('.original-text p');
            node.innerText = text;
        })

        fetch('../texts/friuli-translation.txt')
        .then(response => response.text())
        .then(text => {
            var node = document.querySelector('.translation-text p');
            node.innerText = text;
        })


        // var openFile = function(event) {
        //     var input = event.target;

        //     var reader = new FileReader();
        //     reader.onload = function() {
        //         var text = reader.result;
        //         var node = document.getElementById('output');
        //         node.innerText = text;
        //         console.log(reader.result.substring(0, 200));
        //     };
        //     reader.readAsText(input.files[0]);
        // };

    </script>
</html>